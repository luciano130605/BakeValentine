<!DOCTYPE html>
<html lang="es">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
        <link rel="stylesheet" href="productoP.css" />
        <title>Pepas y scones</title>
</head>

<body>

            <header id="header">
        <img src="img/logo.png" alt="logo">
        <button id="menu-toggle"><i class="fas fa-bars"></i></button>
        <div id="menu">
            <button onclick="location.href='../../index/index.html'">
                <i class="fa-solid fa-house"></i>
            </button>
            <button onclick="location.href='../footer/carrito/carrito.html'"><i
                    class="fas fa-cart-shopping"></i></button>
            <button onclick="location.href='../footer/favoritos/favoritos.html'"><i
                    class="fa-solid fa-heart"></i></button>
            <button onclick="location.href='../footer/contacto/contacto.html'">
                <i class="fa-solid fa-envelope"></i></button>
            </button>
            <button id="user-btn" onclick="goToUser()"><i id="user-icon"
                    class="fa-solid fa-right-to-bracket"></i></button>
        </div>

        <script>

            const toggleBtn = document.getElementById('menu-toggle');
            const menu = document.getElementById('menu');

            toggleBtn.addEventListener('click', () => {
                menu.classList.toggle('show');
            });

            async function updateUserIcon() {
                try {
                    const res = await axios.get("http://127.0.0.1:3000/check-session", { withCredentials: true });
                    const userIcon = document.getElementById("user-icon");

                    if (res.data.logged) {
                        userIcon.className = "fa-solid fa-user"; // ðŸ‘¤ usuario logueado
                    } else {
                        userIcon.className = "fa-solid fa-right-to-bracket"; // ðŸ”‘ sin sesiÃ³n
                    }
                } catch (err) {
                    console.error("Error al verificar sesiÃ³n:", err.message);
                }
            }

            async function goToUser() {
                try {
                    const res = await axios.get("http://127.0.0.1:3000/check-session", { withCredentials: true });
                    if (res.data.logged) {
                        location.href = "../footer//usuario/usuario.html";
                    } else {
                        location.href = "../footer/login/login.html";
                    }
                } catch (err) {
                    // si falla, lo mando al login por defecto
                    location.href = "../footer//login/login.html";
                }
            }

            // cuando cargue el index, pregunto al backend y seteo el Ã­cono
            document.addEventListener("DOMContentLoaded", updateUserIcon);

        </script>

    </header>


        <div class="large grid centered square-grid">
                <h2 class="titulo">Pepas <span>y</span> scones</h2>
        </div>
        <div class="buscador-contenedor">
                <input type="text" id="Buscador" placeholder="Buscar pepas de membrillo, scones..">
                <button id="btn-buscar">
                        <i class="fas fa-search"></i>
                </button>
                <div id="mensaje" class="mensaje-busqueda"></div>
        </div>

        <script type="module" src="buscar.js"></script>

        <div class="productos">
                <button class="pepas" onclick="location.href='../pepas-y-scones/pepaMembrillo.html'"><img
                                src="pepaMembrillo.png">Pepa de membrillo</button>
                <button class="pepas" onclick="location.href='../pepas-y-scones/pepaDdl.html'"><img
                                src="pepaDdl.png">Pepa de dulce de leche</button>
                <button class="pepas" onclick="location.href='../pepas-y-scones/pepaBatata.html'"><img
                                src="pepaBatata.png">Pepa de batata</button>
                <button class="pepas" onclick="location.href='../pepas-y-scones/scone.html'"><img
                                src="scone.png">Scone</button>


        </div>

</body>



</html>